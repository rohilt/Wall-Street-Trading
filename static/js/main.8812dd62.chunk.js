(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{40:function(e,t,n){},51:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n(3),i=n.n(c),s=n(32),l=n.n(s),a=(n(40),n(23)),o=n(15),j=n(33),d=n(16),b=n(9),u=n(19),h=n.n(u),x=n(21),O=n(22);n(47),n(48);O.a.initializeApp({apiKey:"AIzaSyB5-X0jYNuIinzUIprbY8L1YN_R53zbu0M",authDomain:"wall-street-mafia.firebaseapp.com",projectId:"wall-street-mafia",storageBucket:"wall-street-mafia.appspot.com",messagingSenderId:"965478967147",appId:"1:965478967147:web:38a323d3608ec485e38e2e",measurementId:"G-3N44MFRRSB"});var m=O.a.firestore(),f=O.a.functions(),p=function(e){var t=e.onLogin,n=Object(c.useState)(""),i=Object(o.a)(n,2),s=i[0],l=i[1],a=Object(b.g)();return Object(r.jsx)("form",{children:Object(r.jsxs)("fieldset",{children:[Object(r.jsx)("legend",{children:"enter the market"}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{htmlFor:"username",children:"name"}),Object(r.jsx)("input",{id:"username",minLength:1,type:"text",onChange:function(e){return l(e.target.value)}})]}),Object(r.jsx)("button",{onClick:function(e){return s?function(e){e.preventDefault();var n=f.httpsCallable("addPlayer");!function(){var e=Object(x.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n({username:s});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.warn(e.t0);case 8:t(s),a.push("/stocks");case 10:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}()()}(e):null},className:s?"btn btn-primary btn-ghost":"btn btn-error btn-ghost",children:"log in"})]})})},g=function(e){var t=e.prices,n=e.holdings,i=e.player,s=Object(c.useMemo)((function(){return((null===i||void 0===i?void 0:i.buyingPower)||0)+t.reduce((function(e,t){var r,c=t.currentPrice,i=t.symbol;return e+c*((null===(r=n[i])||void 0===r?void 0:r.shares)||0)}),0)}),[t,n,i]);return Object(r.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",flexDirection:"row",alignItems:"flex-start",width:"100%"},children:[Object(r.jsxs)("div",{style:{flexDirection:"column"},children:[Object(r.jsxs)("div",{className:"terminal-alert terminal-alert-primary",style:{flexShrink:5},children:[Object(r.jsx)("b",{children:"buying power"}),": $",(null===i||void 0===i?void 0:i.buyingPower.toFixed(2))||"--.--"]}),Object(r.jsxs)("div",{className:"terminal-alert terminal-alert-primary",style:{flexShrink:5},children:[Object(r.jsx)("b",{children:"total equity"}),": $",s.toFixed(2)||"--.--"]})]}),Object(r.jsxs)("div",{style:{flexGrow:3,marginRight:50,marginLeft:50},children:[Object(r.jsx)("header",{children:Object(r.jsx)("h2",{children:" available stocks "})}),Object(r.jsxs)("table",{children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{children:"symbol"}),Object(r.jsx)("th",{children:"last exec. price"}),Object(r.jsx)("th",{children:"no. of shares"}),Object(r.jsx)("th",{children:"total equity"}),Object(r.jsx)("th",{children:"avg. cost"})]})}),Object(r.jsx)("tbody",{children:t.map((function(e){var t=e.symbol,c=e.currentPrice,i=n[t],s=(null===i||void 0===i?void 0:i.shares)||0;return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:Object(r.jsx)(d.b,{to:"/orders/".concat(t),children:t})}),Object(r.jsxs)("td",{children:["$",c.toFixed(2)]}),Object(r.jsx)("td",{children:s}),Object(r.jsxs)("td",{children:["$",(c*s).toFixed(2)]}),Object(r.jsx)("td",{children:i?"$".concat(i.avgCost.toFixed(2)):"-"})]},t)}))})]})]})]})},y=function(e){var t,n,i=e.prices,s=e.holdings,l=e.player,a=Object(b.h)().symbol,j=Object(b.g)(),u=Object(c.useRef)({isBid:!0,symbol:a||"",price:(null===(t=i.find((function(e){return e.symbol===a})))||void 0===t?void 0:t.currentPrice)||.01,amount:1,playerID:l.id}),O=function(){return Number(u.current.price)*Number(u.current.amount)},m=Object(c.useState)(O),p=Object(o.a)(m,2),g=p[0],y=p[1],v=function(e,t){u.current[e]=t,console.log(u.current),y(O())};return Object(r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(r.jsxs)("div",{style:{flexGrow:1,marginRight:50,marginLeft:50},children:[Object(r.jsx)("header",{children:Object(r.jsx)("h2",{children:" current prices "})}),Object(r.jsxs)("table",{children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{children:"symbol"}),Object(r.jsx)("th",{children:"price"})]})}),Object(r.jsx)("tbody",{children:i.map((function(e){var t=e.symbol,n=e.currentPrice;return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:t}),Object(r.jsxs)("td",{children:["$",n.toFixed(2)]})]},t)}))})]})]}),Object(r.jsxs)("div",{style:{flexGrow:3,marginLeft:50,marginRight:50},children:[Object(r.jsxs)("div",{className:"terminal-alert terminal-alert-primary",children:[Object(r.jsx)("b",{children:"buying power"}),": $",l?l.buyingPower.toFixed(2):"--.--"]}),Object(r.jsx)("form",{children:Object(r.jsxs)("fieldset",{children:[Object(r.jsx)("legend",{children:"submit a trade"}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{htmlFor:"select",children:"trade type"}),Object(r.jsx)("br",{}),Object(r.jsx)("input",{type:"radio",id:"bid",name:"type",onChange:function(e){return v("isBid",!0)}}),Object(r.jsx)("label",{htmlFor:"bid",children:"bid"}),"\xa0\xa0\xa0",Object(r.jsx)("input",{type:"radio",id:"ask",name:"type",onChange:function(e){return v("isBid",!1)}}),Object(r.jsx)("label",{htmlFor:"ask",children:"ask"}),Object(r.jsx)("br",{}),Object(r.jsx)("label",{htmlFor:"symbol",children:"symbol"}),Object(r.jsx)("input",{type:"text",id:"symbol",minLength:1,defaultValue:a,onChange:function(e){return v("symbol",e.target.value)}}),Object(r.jsx)("label",{htmlFor:"price",children:"price"}),Object(r.jsx)("input",{id:"price",type:"number",min:.01,step:.01,defaultValue:Math.round(100*((null===(n=i.find((function(e){return e.symbol===a})))||void 0===n?void 0:n.currentPrice)||0))/100,onChange:function(e){return v("price",Number(e.target.value))}}),Object(r.jsx)("label",{htmlFor:"quantity",children:"quantity"}),Object(r.jsx)("input",{id:"quantity",type:"number",min:1,step:1,defaultValue:1,onChange:function(e){return v("amount",Number(e.target.value))}}),Object(r.jsxs)("h2",{children:["Total cost: ",Object(r.jsxs)("u",{children:["$",g]})]})]}),Object(r.jsx)("button",{className:"btn btn-ghost",onClick:function(e){e.preventDefault(),function(){var e=Object(x.a)(h.a.mark((function e(){var t,n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u.current.isBid){e.next=6;break}if(!(O()>l.buyingPower)){e.next=4;break}return window.alert("Not enough buying power."),e.abrupt("return");case 4:e.next=9;break;case 6:if(!(u.current.amount>(null===(t=s[String(u.current.symbol)])||void 0===t?void 0:t.shares))){e.next=9;break}return window.alert("Not enough shares."),e.abrupt("return");case 9:n=f.httpsCallable("addOrder");try{n(u.current),u.current={isBid:!0,symbol:a||"",price:(null===(r=i.find((function(e){return e.symbol===a})))||void 0===r?void 0:r.currentPrice)||0,amount:0,playerID:l.id},j.push("/stocks")}catch(c){console.warn(c)}case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()},children:"trade"})]})}),Object(r.jsx)("hr",{}),Object(r.jsx)("h2",{children:"current holdings"}),Object(r.jsx)("span",{children:"\xa0\xb7\xa0"}),Object.keys(s).map((function(e){return Object(r.jsxs)("span",{children:[Object(r.jsx)(d.b,{to:"/orders/".concat(e),children:e}),"\xa0\xb7\xa0"]},e)})),Object(r.jsx)("br",{}),Object(r.jsx)("br",{}),Object(r.jsx)("div",{style:{display:"flex",flexWrap:"wrap"},children:Object.entries(s).map((function(e){var t,n=Object(o.a)(e,2),c=n[0],s=n[1];return Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{className:"terminal-card",children:[Object(r.jsx)("header",{children:c}),Object(r.jsxs)("div",{children:["Number of shares: ",s.shares,Object(r.jsx)("br",{}),"Total equity: $",(((null===(t=i.find((function(e){return e.symbol===s.symbol})))||void 0===t?void 0:t.currentPrice)||0)*s.shares).toFixed(2)]})]}),Object(r.jsx)("br",{})]},c)}))})]})]})};var v=function(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),n=t[0],i=t[1],s=Object(c.useState)([]),l=Object(o.a)(s,2),u=l[0],h=l[1],x=Object(c.useState)({}),O=Object(o.a)(x,2),f=O[0],v=O[1],w=Object(c.useState)(null),k=Object(o.a)(w,2),N=k[0],F=k[1];Object(c.useEffect)((function(){return m.collection("stocks").onSnapshot((function(e){var t=[];e.forEach((function(e){return t.push(e.data())})),h(t),console.log(t)}))}),[]),Object(c.useEffect)((function(){if(n)return m.collection("players").where("username","==",n).onSnapshot((function(e){var t=e.docs[0];t&&F(t.data()||null)}));F(null)}),[n]),Object(c.useEffect)((function(){return m.collection("players").doc(String(null===N||void 0===N?void 0:N.id)).collection("holdings").onSnapshot((function(e){var t={};e.forEach((function(e){var n=e.data();t[n.symbol]=n})),v(t),console.log(t)}))}),[N]);var S={prices:u,holdings:f,player:N};return Object(r.jsxs)(d.a,{children:[n?null:Object(r.jsx)(b.a,{to:"/login"}),Object(r.jsxs)("div",{className:"terminal",style:{display:"flex",height:"100%",flexDirection:"column"},children:[Object(r.jsxs)("div",{className:"terminal-nav",style:{alignItems:"flex-start",marginLeft:100,marginRight:100},children:[Object(r.jsxs)("header",{className:"terminal-logo",children:[Object(r.jsx)("div",{className:"logo terminal-prompt",children:"wall street trading"}),Object(r.jsx)("blockquote",{children:Object(r.jsx)("small",{children:"the markets can remain irrational longer than you can remain solvent"})})]}),Object(r.jsx)("nav",{className:"terminal-menu",children:Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:Object(r.jsx)(d.b,{to:"/stocks",children:Object(r.jsx)("a",{href:".",children:"stocks"})})}),Object(r.jsx)("li",{children:Object(r.jsx)(d.b,{to:"/orders",children:Object(r.jsx)("a",{href:".",children:"orders"})})}),Object(r.jsx)("li",{children:n||Object(r.jsx)("b",{children:"not logged in"})})]})})]}),Object(r.jsx)("div",{className:"container",style:{padding:0,flex:1,overflow:"auto",paddingBottom:"10%"},children:Object(r.jsxs)(b.d,{children:[Object(r.jsx)(b.b,{path:"/login",children:Object(r.jsx)(p,{onLogin:function(e){i(e)}})}),Object(r.jsx)(b.b,{path:"/stocks",children:n?Object(r.jsx)(g,Object(a.a)({},S)):Object(r.jsx)(b.a,{to:"/login"})}),Object(r.jsx)(b.b,{path:"/orders/:symbol",children:n?Object(r.jsx)(y,Object(a.a)({},S)):Object(r.jsx)(b.a,{to:"/login"})}),Object(r.jsx)(b.b,{path:"/orders",children:n?Object(r.jsx)(y,Object(a.a)({},S)):Object(r.jsx)(b.a,{to:"/login"})}),Object(r.jsx)(b.b,{path:"/",children:Object(r.jsx)(b.a,{to:"/login"})})]})}),Object(r.jsx)("div",{className:"terminal-alert",style:{bottom:0,position:"fixed",width:"100%",backgroundColor:"#000000",color:"#3db818",margin:0,padding:0,borderWidth:0,borderTopWidth:1},children:Object(r.jsx)(j.a,{offset:"run-in",children:function(){return u.length?u.map((function(e){var t=e.symbol,n=e.currentPrice;return Object(r.jsxs)("h1",{style:{color:"#7ee460"},children:[t," $",n.toFixed(2),"\xa0\xb7\xa0"]},t)})):Object(r.jsx)("h1",{children:"\xa0"})}})})]})]})},w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,52)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),i(e),s(e)}))};l.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(v,{})}),document.getElementById("root")),w()}},[[51,1,2]]]);
//# sourceMappingURL=main.8812dd62.chunk.js.map